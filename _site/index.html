<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>Solar Theme</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-dark.css" rel="stylesheet" />

</head>

<body>



  <header id="header">
    <h1><a href="/"><i class="icon-sun"></i> </a></h1>
    <p></p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/redwall_hp">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      

	<article class="post">

		
			<h1><a href="/2016/10/17/scipy-yocto-edison/">Getting started with the Intel Edison</a></h1>
		

		<div class="post-content"><p>With the Sparkfun breakout blocks the Intel Edison becomes a compact, powerful, mechanically robust target board for robotics</p>

<p>Parts list:</p>
<ul>
  <li><a href="https://www.sparkfun.com/products/13024">Intel Edison</a></li>
  <li><a href="https://www.sparkfun.com/products/13045">Sparkfun base block</a></li>
  <li><a href="https://www.sparkfun.com/products/13033">Sparkfun 9DoF IMU block with the ST Micro LSM9DS0</a></li>
</ul>

<p>Ubilinux has been a popular distribution for the Edison in the past. As of June 2016, Emutex no longer supports Ubilinux on Edison.</p>

<p><a href="https://www.yoctoproject.org/">Yocto</a> is the distribution</p>

<h1 id="installing-yocto">Installing Yocto:</h1>

<p>Plug both cables into the base block</p>

<p>Update the firmware, create a password, and connect to wifi as described here:
<a href="https://software.intel.com/en-us/get-started-edison-windows-step2">https://software.intel.com/en-us/get-started-edison-windows-step2</a></p>

<p>Connect to the Edison using TeraTerm, putty, or GNU screen</p>

<p>Although branded as a system to compile custom OS images for your target board, Yocto also includes a conventional, apt-like package manager. No repositories are included by default, so you’ll need to add them like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>echo "src/gz all http://repo.opkg.net/edison/repo/all"           &gt;&gt; /etc/opkg/base-feeds.conf
echo "src/gz edison http://repo.opkg.net/edison/repo/edison"     &gt;&gt; /etc/opkg/base-feeds.conf 
echo "src/gz core2-32 http://repo.opkg.net/edison/repo/core2-32" &gt;&gt; /etc/opkg/base-feeds.conf
opkg update
</code></pre>
</div>

<p>A full list of packages  available through opkg can be found <a href="http://repo.opkg.net/edison/repo/core2-32/">here</a></p>

<h1 id="installing-packages---numpy-pyplot-smbus-and-scipy">Installing Packages - numpy, pyplot, smbus and scipy:</h1>

<p>We’ll need the smbus package to communicate with the LSM9DS0. Git and screen will be convenient.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>opkg install git screen python-smbus
</code></pre>
</div>

<p>Scipy can be installed from pip. You’ll see some error messages about not having support for HTTPS, but that’s okay.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>pip install --upgrade pip
pip install numpy scipy matplotlib
</code></pre>
</div>

<h1 id="plotting-acceleration">Plotting Acceleration:</h1>

<p><a href="/images/random/hello_imu.png"><img src="/images/random/hello_imu.png" style="width: 200px;" align="right" /></a></p>

<p>You’ll need to find python drivers for the LSM9DS0. As of October 2016, you can find a driver <a href="git clone https://github.com/oresat/reaction-wheels.git">here</a>.</p>

<p>I’ve uploaded a python script to read and plot data from the IMU at this <a href="https://gist.github.com/fkoran/d46e720500a208c3bcbef88e03954f63">gist</a></p>

</div>

	</article>



	<article class="post">

		
			<h1><a href="/2016/09/13/git-ssh-permissions-too-open/">Git SSH Permissions</a></h1>
		

		<div class="post-content"><!-- Need better formatting for <code> blocks
syntax highlighting would be nice -->

<p>Your keys might be generated and shared correctly, but git wants to enforce good security practice by demanding that your private key not be writable by other users on your system.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>fkoran@host~/$ git push
...
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0770 for '/home/fkoran/.ssh/id_rsa' are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key "/home/fkoran/.ssh/id_rsa": bad permissions
Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
fkoran@host:~/$ ls -l ~/.ssh/id_rsa
-rwxrwx--- 1 fkoran fkoran 3326 Jan  6  2016 /home/fkoran/.ssh/id_rsa
</code></pre>
</div>

<p>To fix this, use <a href="http://linux.die.net/man/1/chmod">chmod</a> to remove write permissions for users in the “group” and “other” categories.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>fkoran@host:~/$ chmod go-w ~/.ssh/id_rsa
fkoran@host:~/$ ls -l ~/.ssh/id_rsa
-rwxr-x--- 1 fkoran fkoran 3326 Jan  6  2016 /home/fkoran/.ssh/id_rsa
</code></pre>
</div>

<p>More detailed information can be found <a href="http://bodhizazen.net/Tutorials/SSH_keys#Login">here</a></p>
</div>

	</article>



	<article class="post">

		
			<h1><a href="/2016/09/06/ergodox/">Ergodox Build</a></h1>
		

		<div class="post-content"><!-- Need photos for:
- keyswitch layout inc. edges with ambiguous orientation
- finished product
- shot of the tools
- pcb, layer 3, and switches alone
- format tables, generate small images -->

<!-- [<img src="/images/ergodox/beauty_small.jpg" style="width: 480px;" align="center"/>](/images/ergodox/beauty.jpg) -->

<p><a href="#parts">Parts</a> |
<a href="#case">Case</a> |
<a href="#assembly-instructions">Assembly</a> |
<a href="#troubleshooting">Troubleshooting</a></p>

<h1 id="parts">Parts</h1>

<p>I purchased parts on DigiKey per the <a href="http://ergodox.org">ergodox.org</a> list, which I’ll reproduce here since that site is currently offline</p>

<!-- | Ergodox PCB 							| [mechanicalkeyboards.com]( https://mechanicalkeyboards.com/shop/index.php?l=product_detail&p=537 ) 			|									|
| Teesny 2.0 with headers 					| [mechanicalkeyboards.com]( https://mechanicalkeyboards.com/shop/index.php?l=product_detail&p=568 ) 			|									|
| 10x Gateron Brown Keyswitch - Plate Mount - Pack of 10	| [mechanicalkeyboards.com]( https://mechanicalkeyboards.com/shop/index.php?l=product_detail&p=1640 ) 			|									|
| DSA Keycaps - Ergodox Base Set and Ergodox Modifier Set 	| [pimpmykeyboard.com]( http://pimpmykeyboard.com/dsa-pbt-abs-blank-keycap-sets/ ) 					|									|
| 4 Conductor 3.5mm TRRS Audio Cable 				| [amazon]( http://amzn.to/2cAZh8s )											|									|
| CP-43514 4 Conductor 3.5mm TRRS Audio Jack 			| [digikey]( http://www.digikey.com/product-detail/en/cui-inc/SJ-43514/CP-43514-ND/368146 )				|									|
| WM17115-ND USB Mini-B Receptacle 				| [digikey]( http://www.digikey.com/product-detail/en/molex-llc/0548190519/WM17115-ND/773802 ) 				| **often out of stock** 						|
| MCP23018 IO Expander 						| [digikey]( http://www.digikey.com/product-detail/en/microchip-technology/MCP23018-E-SP/MCP23018-E-SP-ND/1999505 )	|									|
| 0.1uF Through-hole Ceramic Capacitor 				| [digikey]( http://www.digikey.com/product-detail/en/vishay-bc-components/K104K10X7RF5UH5/BC2665CT-ND/2356879 ) 	|									|
| 2x 2.2kΩ Through-hole Resistor 				| [digikey]( http://www.digikey.com/product-detail/en/yageo/CFR-25JB-52-2K2/2.2KQBK-ND/666 ) 				|									|
| 4x 220Ω Through-hole Resistor 				| [digikey]( http://www.digikey.com/product-detail/en/yageo/CFR-25JB-52-220R/220QBK-ND/1295 ) 				|									|
| <strike>100x Axial Through-hole Diode 			| [digikey]( http://www.digikey.com/product-detail/en/fairchild-semiconductor/1N4148/1N4148FS-ND/458603 )</strike> 	| **recommend substituting the surface mount diodes listed below:**	|
| 100x SOT123 Surface Mount Diode 				| [digikey]( http://www.digikey.com/product-detail/en/diodes-incorporated/1N4148W-7-F/1N4148W-FDICT-ND/815280 ) 	|									|
| *3mm Green LED 						| [digikey]( http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4236N/160-1144-ND/214443 ) (optional)* 		|									|
| *3mm Yellow LED 						| [digikey]( http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4256N/160-1147-ND/151820 ) (optional)* 		|									|
| *3mm Red LED 							| [digikey]( http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4266N/160-1034-ND/121770 ) (optional)* 		|									| -->

<ul>
  <li><a href="https://mechanicalkeyboards.com/shop/index.php?l=product_detail&amp;p=537">Ergodox PCB</a></li>
  <li><a href="https://mechanicalkeyboards.com/shop/index.php?l=product_detail&amp;p=568">Teesny 2.0 with headers</a></li>
  <li><a href="https://mechanicalkeyboards.com/shop/index.php?l=product_detail&amp;p=1640">10x Gateron Brown Keyswitch - Plate Mount - Pack of 10</a></li>
  <li><a href="http://pimpmykeyboard.com/dsa-pbt-abs-blank-keycap-sets/">DSA Keycaps - Ergodox Base Set and Ergodox Modifier Set</a></li>
  <li><a href="http://amzn.to/2cAZh8s">4 Conductor 3.5mm TRRS Audio Cable</a></li>
  <li><a href="http://www.digikey.com/product-detail/en/cui-inc/SJ-43514/CP-43514-ND/368146">CP-43514 4 Conductor 3.5mm TRRS Audio Jack</a></li>
  <li><a href="http://www.digikey.com/product-detail/en/molex-llc/0548190519/WM17115-ND/773802">WM17115-ND USB Mini-B Receptacle</a> - <strong>often out of stock</strong></li>
  <li><a href="http://www.digikey.com/product-detail/en/microchip-technology/MCP23018-E-SP/MCP23018-E-SP-ND/1999505">MCP23018 IO Expander</a></li>
  <li><a href="http://www.digikey.com/product-detail/en/vishay-bc-components/K104K10X7RF5UH5/BC2665CT-ND/2356879">0.1uF Through-hole Ceramic Capacitor</a></li>
  <li><a href="http://www.digikey.com/product-detail/en/yageo/CFR-25JB-52-2K2/2.2KQBK-ND/666">2x 2.2kΩ Through-hole Resistor</a></li>
  <li><a href="http://www.digikey.com/product-detail/en/yageo/CFR-25JB-52-220R/220QBK-ND/1295">4x 220Ω Through-hole Resistor</a></li>
  <li><a href="http://www.digikey.com/product-detail/en/fairchild-semiconductor/1N4148/1N4148FS-ND/458603"><strike>100x Axial Through-hole Diode</strike></a> - <strong>recommend substituting the surface mount diodes listed below:</strong></li>
  <li><a href="http://www.digikey.com/product-detail/en/diodes-incorporated/1N4148W-7-F/1N4148W-FDICT-ND/815280">100x SOT123 Surface Mount Diode </a></li>
  <li><a href="http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4236N/160-1144-ND/214443">3mm Green LED</a> - <strong>optional</strong></li>
  <li><a href="http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4256N/160-1147-ND/151820">3mm Yellow LED </a> - <strong>optional</strong></li>
  <li><a href="http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4266N/160-1034-ND/121770">3mm Red LED </a> - <strong>optional</strong></li>
</ul>

<!-- <table>
<tr>
 <td>Ergodox PCB</td>
 <td>[mechanicalkeyboards.com]( https://mechanicalkeyboards.com/shop/index.php?l=product_detail&p=537 )/td>
 <td>/td>
</tr>
<tr>
 <td>Teesny 2.0 with headers/td>
 <td>[mechanicalkeyboards.com]( https://mechanicalkeyboards.com/shop/index.php?l=product_detail&p=568 )/td>
 <td>/td>
</tr>
<tr>
 <td>10x Gateron Brown Keyswitch - Plate Mount - Pack of 10/td>
 <td>[mechanicalkeyboards.com]( https://mechanicalkeyboards.com/shop/index.php?l=product_detail&p=1640 )/td>
 <td>/td>
</tr>
<tr>
 <td>DSA Keycaps - Ergodox Base Set and Ergodox Modifier Set/td>
 <td>[pimpmykeyboard.com]( http://pimpmykeyboard.com/dsa-pbt-abs-blank-keycap-sets/ )/td>
 <td>/td>
</tr>
<tr>
 <td>4 Conductor 3.5mm TRRS Audio Cable/td>
 <td>[amazon]( http://amzn.to/2cAZh8s )/td>
 <td>/td>
</tr>
<tr>
 <td>CP-43514 4 Conductor 3.5mm TRRS Audio Jack/td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/cui-inc/SJ-43514/CP-43514-ND/368146 )/td>
 <td>/td>
</tr>
<tr>
 <td>WM17115-ND USB Mini-B Receptacle/td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/molex-llc/0548190519/WM17115-ND/773802 )/td>
 <td>**often out of stock**/td>
</tr>
<tr>
 <td>MCP23018 IO Expander/td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/microchip-technology/MCP23018-E-SP/MCP23018-E-SP-ND/1999505 )/td>
 <td>/td>
</tr>
<tr>
 <td>0.1uF Through-hole Ceramic Capacitor/td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/vishay-bc-components/K104K10X7RF5UH5/BC2665CT-ND/2356879 )/td>
 <td>/td>
</tr>
<tr>
 <td>2x 2.2kΩ Through-hole Resistor</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/yageo/CFR-25JB-52-2K2/2.2KQBK-ND/666 )</td>
 <td></td>
</tr>
<tr>
 <td>4x 220Ω Through-hole Resistor</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/yageo/CFR-25JB-52-220R/220QBK-ND/1295 )</td>
 <td></td>
</tr>
<tr>
 <td><strike>100x Axial Through-hole Diode</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/fairchild-semiconductor/1N4148/1N4148FS-ND/458603 )</strike></td>
 <td>**recommend substituting the surface mount diodes listed below:**</td>
</tr>
<<tr>
 <td>100x SOT123 Surface Mount Diode</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/diodes-incorporated/1N4148W-7-F/1N4148W-FDICT-ND/815280 )</td>
 <td></td>
</tr>
<tr>
 <td>*3mm Green LED</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4236N/160-1144-ND/214443 )</td>
 <td>(optional)*</td>
</tr>
<tr>
 <td>*3mm Yellow LED</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4256N/160-1147-ND/151820 )</td>
 <td>(optional)*</td>
</tr>
<tr>
 <td>*3mm Red LED</td>
 <td>[digikey]( http://www.digikey.com/product-detail/en/lite-on-inc/LTL-4266N/160-1034-ND/121770 )</td>
 <td>(optional)*</td>
</tr>
</table> -->

<p>If I were building this again I would substitute surface mount parts in place of the through hole diodes. They’re easier to solder and trim and will result in a cleaner final product with wider mechanical clearances. Be aware that the mini-USB B connecter often goes out of stock.</p>

<p>I chose to use Gateron Brown switches. They seem widely regarded as a better quality clone of the gold standard Cherry MX brand and have a <a href="http://www.wasdkeyboards.com/mechanical-keyboard-guide#best">light, tactile throw</a> without being clicky.</p>

<p>Note that a standard, stereo audio cable isn’t enough to connect the two sides. You need a four conductor TRRS cable (the extra aRRRR is for tip-ring-ring-sleeve) to carry GND, +5, and I²C SDA/SCL.</p>

<p>There are a couple standard keycap profiles. DSA is convenient because keys are <a href="http://pimpmykeyboard.com/key-cap-family-specs/">interchangable</a> between rows. This was especially desirable because I planned to use the <a href="http://chetansurpur.com/blog/2012/11/colemak.html">Colemak</a> layout, for which profiled keycaps would be hard to find</p>

<h1 id="case">Case</h1>

<p>I pulled what appear to be Litster’s original .DXF files from <a href="https://github.com/bishboria/ErgoDox/tree/master/ErgoDox%20Acrylic%20Case">bishboria’s github</a> and exported them to SVG using Inkscape.</p>

<p><a href="/images/ergodox/ponoko.png"><img src="/images/ergodox/ponoko.png" style="width: 480px;" align="center" /></a></p>

<p>I had the acrylic cut at <a href="https://www.ponoko.com/">Ponoko</a>. Unfortunately I made a mistake scaling one of the spacer layers in the process of tiling the SVGs onto a single panel, so I had to substitute some washers for L3-Left until I get access to a bandsaw or a 3D printer.</p>

<p>The SVGs are up on <a href="https://github.com/fkoran/ergodox-acrylic-svg">my github</a>.</p>

<p><a href="/images/ergodox/layer_all_left.jpg"><img src="/images/ergodox/layer_all_left_small.jpg" style="width: 480px;" align="center" /></a></p>

<p>These are the layer thicknesses I used. The Gateron switches fit perfectly with 4.5mm acrylic on layer 3. Be sure if you’re using THT diodes that layer 4 is a bit thicker than 4.5mm.</p>

<ul>
  <li>Top - 3mm</li>
  <li>Spacer - 4.5mm</li>
  <li>Switch plate - 4.5mm</li>
  <li>Spacer - 4.5mm</li>
  <li>Bottom - 3mm</li>
</ul>

<h1 id="assembly-instructions">Assembly Instructions</h1>

<p>I used the <a href="https://keyboard-configurator.massdrop.com/ext/ergodox/assembly.php">Massdrop</a> assembly instructions as a reference. If this is your first soldering project it’s worth flipping through the <a href="https://mightyohm.com/files/soldercomic/FullSolderComic_EN.pdf">Soldering is Easy (8 page pdf)</a></p>

<p><a href="/images/ergodox/parts_pcb_acrylic_keys_caps.jpg"><img src="/images/ergodox/parts_pcb_acrylic_keys_caps_small.jpg" style="width: 480px;" align="center" /></a></p>

<h2 id="tools">Tools</h2>

<!-- [<img src="/images/ergodox/null_small.jpg" style="width: 480px;" align="center"/>](/images/ergodox/null.jpg) -->

<ul>
  <li><a href="http://amzn.to/2cAUvrr">Digitally temperature regulated soldering iron</a></li>
  <li><a href="http://amzn.to/2cAXe47">Solder</a></li>
  <li><a href="http://amzn.to/2cAV9Wb">Tweezers</a></li>
  <li><a href="http://amzn.to/2cAUfJ2">Helping hand </a> or <a href="http://amzn.to/2cAUzHW">multi-purpose hobby vise</a></li>
  <li><a href="http://amzn.to/2cAV84l">20-30 gauge wire stripping tool</a></li>
  <li><a href="http://amzn.to/2cATtvy">Flush cut wire trimmers</a></li>
</ul>

<h2 id="for-tht-diodes">For THT diodes</h2>

<p>Bend each diode into a U shape and populate the marked spaces below each of the keyswitch sockets</p>

<p><a href="/images/ergodox/assembly_diodes_sharp_side.jpg"><img src="/images/ergodox/assembly_diodes_sharp_side_small.jpg" style="width: 480px;" align="center" /></a></p>

<p>Confirm that each diode is oriented so that the cathode, marked with a black ring, is closer to the square solder pad</p>

<p><a href="/images/ergodox/assembly_diodes_magnified.jpg"><img src="/images/ergodox/assembly_diodes_magnified_small.jpg" style="width: 480px;" align="center" /></a></p>

<p>Clip the leads with a pair of flush cut trimmers and press the diode bodies flat against the PCB</p>

<p><a href="/images/ergodox/assembly_diode_clip.jpg"><img src="/images/ergodox/assembly_diode_clip_small.jpg" style="width: 480px;" align="center" /></a></p>

<!-- [<img src="/images/ergodox/null_small.jpg" style="width: 480px;" align="center"/>](/images/ergodox/null.jpg) -->

<h2 id="for-smt-diodes">For SMT diodes</h2>

<p>Solder a diode below each of the keyswitch sockets. Confirm that each diode is oriented so that the cathode, marked with a white line, is closer to the square solder pad</p>

<p><a href="https://learn.sparkfun.com/tutorials/polarity/diode-and-led-polarity">https://learn.sparkfun.com/tutorials/polarity/diode-and-led-polarity</a></p>

<h2 id="resistors">Resistors</h2>

<p>The resistors are color coded. (relevant <a href="https://xkcd.com/227/">xkcd</a>)</p>

<p><a href="/images/ergodox/parts_resistor_2_2k.jpg"><img src="/images/ergodox/parts_resistor_2_2k_small.jpg" style="width: 480px;" align="center" /></a>
<a href="/images/ergodox/parts_resistor_220ohm.jpg"><img src="/images/ergodox/parts_resistor_220ohm_small.jpg" style="width: 480px;" align="center" /></a></p>

<h2 id="trrs-connector-35mm-audio-jack">TRRS Connector (3.5mm audio jack)</h2>

<p>Populate the jumpers as shown. These are needed to reuse the same PCB for left and right hands</p>

<p><a href="/images/ergodox/assembly_trrs_jumpers_stuffed.jpg"><img src="/images/ergodox/assembly_trrs_jumpers_stuffed_small.jpg" style="width: 480px;" align="center" /></a></p>

<h2 id="io-expander">IO Expander</h2>

<p>Populate the IO expander DIP as shown</p>

<p><a href="/images/ergodox/assembly_mcu_cap.jpg"><img src="/images/ergodox/assembly_mcu_cap_small.jpg" style="width: 480px;" align="center" /></a></p>

<h2 id="teensy">Teensy</h2>

<p>Cut and strip the spare USB mini-B cable to bridge from the PCB to the Teensy</p>

<p><a href="/images/ergodox/assembly_usb_cut_alt.gif"><img src="/images/ergodox/assembly_usb_cut_alt.gif" style="width: 480px;" align="center" /></a></p>

<p>Plug the 12 pin inline headers into the right hand PCB and stack the Teesny 2.0 on top of them. Tack down two pins on opposing corners to hold the assembly in place before soldering the rest</p>

<p><a href="/images/ergodox/assembly_complete_minus_keys.jpg"><img src="/images/ergodox/assembly_complete_minus_keys_small.jpg" style="width: 480px;" align="center" /></a></p>

<h2 id="keyswitches">Keyswitches</h2>

<p>Plug the keyswitches into the layer 3 support plate. Place the support plate switch-side down on a table and align the PCB with the switch pins. Solder the switches down while the support plate is sandwiched between the keyswitches and the PCB.</p>

<p><a href="/images/ergodox/assembly_switches_alt.jpg"><img src="/images/ergodox/assembly_switches_alt_small.jpg" style="width: 480px;" align="center" /></a></p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>The left side of the keyboard worked perfectly on the first try. As soon as I plugged in the right side my laptop started opening the Win+X menu.</p>

<p>I rebuilt the <a href="https://github.com/benblazak/ergodox-firmware">firmware</a> to generate a ‘z’ from what had been the windows key and got a spray of “bzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvb”</p>

<p><a href="/images/ergodox/troubleshoot_keytest.png"><img src="/images/ergodox/troubleshoot_keytest.png" style="width: 480px;" align="center" /></a></p>

<p>After a quick visual inspection to verify that the diodes were all oriented correctly, I brought up the <a href="https://github.com/bishboria/ErgoDox/tree/master/ErgoDOX%20pcb">board file</a></p>

<p><a href="/images/ergodox/troubleshoot_schematic.png"><img src="/images/ergodox/troubleshoot_schematic.png" style="width: 480px;" align="center" /></a></p>

<p>When the firmware performs a scan it pulls each column low in turn. While a given column is low it checks each row to see if a closed switch is connecting the two. Komar has a good overview of this on his <a href="http://blog.komar.be/how-to-make-a-keyboard-the-matrix/">site</a>. All the affected keys were on the ROW2 net.</p>

<p>Since each row net surfaces only at the IO expander and at the switches of that row, I had only to check for solder bridges at those points. I found a solder bridge between a switch contact and a mounting hole. The mounting hole didn’t have any external cladding but on inspection with a meter I found that the solder bridge was shorting directly to the ground plane.</p>

<!-- 
# Conclusion

I have a Surface Pro 4 and the difference between that and an ergodox is too big to traverse on a daily basis. It was still a fun project.


on plugging in the left side, the keyboard behaved funny, opening the win
+x menu
I edited the firmware to generate a 'z' from what had been the windows key and got a spray of "bzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvbzzxcvb"
I installed the keyboard test sw from passmark and confirmed that all keys on the bottom row were held down. Those keys retain the same position in colemak.
visually it appears there might be a solder bridge on one of these keys, but it's between two vias that are shorted anyway
there isn't an easy way for relevant pins to short
was a diode installed backwards? check tomorrow

after a quick visual inspection to verify that the diodes were all installe correctly, i bruoght up th schematic

when the firmware performs a scan, it pulls each collumn low in turn, and checks each row to see if a switch is closed to connec the two

since one row is always activve, at seems like one row is being held low

this is easy, since each row line is connecte only to the input pin an the switches of that row, surfacing only at the switch holes

there was a solder bridge from a switch contact to a m
ounting hole. the mounting hole didn't have any visible cladding, but on probing with a meter, the sides of the hole are connected to ground

iven how close these holes are and how poor many of our soldering skills are, I think it's likely that this kind of bridging is at fault for many stuck rows. [check the forums to see if this is the case?]

replace stroke-width:[^;"]* with stroke-width:0.01mm
 -->
</div>

	</article>






    </div>



  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2016 . Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>



</body>
</html>